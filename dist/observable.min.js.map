{"version":3,"file":"observable.min.js","sources":["../src/observable.js"],"sourcesContent":["/**\n * @template T\n * @typedef {(next: T, prev: T | undefined) => void} Subscriber\n */\n\n/**\n * Creates reactive object allowing set new value and subscribe to the value change.\n * If new value isn't equal to previous, each callback passed via subscribe method will be fired.\n * @template T\n * @class Observable\n */\n\nclass Observable {\n  /** @type {T | undefined} */\n  internal;\n\n  /** @type {Array<Subscriber<T>>} */\n  callbacks = [];\n\n  /** Allows to set initial value\n   * @param {T} [initial]\n   */\n  constructor(initial) {\n    this.internal = initial;\n  }\n\n  /**\n   * Higher order function acceping subscriber and returning unsubscriber\n   * @param {Subscriber<T>} callback a function accepting next and prev values\n   * @returns {() => void} unsubscriber function stops firing callback\n   */\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('[createObservable]: expected callback to be a function.');\n    }\n    this.callbacks.push(callback);\n    return () => {\n      const index = this.callbacks.indexOf(callback);\n      this.callbacks = this.callbacks.slice(0, index).concat(this.callbacks.slice(index + 1));\n    };\n  }\n\n  /** @returns {T | undefined} */\n  get value() {\n    return this.internal;\n  }\n\n  /** @param {T | undefined} next */\n  set value(next) {\n    if (next !== this.internal) {\n      const prev = this.internal;\n      this.internal = next;\n      for (let i = 0; i < this.callbacks.length; i++) {\n        this.callbacks[i](this.internal, prev);\n      }\n    }\n  }\n}\n\nexport default Observable;\n"],"names":["Observable","initial","this","callbacks","internal","prototype","subscribe","callback","_this","TypeError","push","index","indexOf","slice","concat","key","get","set","next","prev","i","length"],"mappings":"mVAsBE,SAAAA,WAAYC,GAASC,KALrBC,UAAY,GAMVD,KAAKE,SAAWH,CAClB,CAAC,QAgBA,OAhBAD,WAAAK,UAODC,UAAA,SAAUC,GAAU,IAAAC,EAClBN,KAAA,GAAwB,mBAAbK,EACT,MAAU,IAAAE,UAAU,2DAGtB,OADAP,KAAKC,UAAUO,KAAKH,cAElB,IAAMI,EAAQH,EAAKL,UAAUS,QAAQL,GACrCC,EAAKL,UAAYK,EAAKL,UAAUU,MAAM,EAAGF,GAAOG,OAAON,EAAKL,UAAUU,MAAMF,EAAQ,GACtF,CACF,IAACX,gBAAAe,IAAA,QAAAC,IAGD,WACE,OAAWd,KAACE,QACd,EAACa,IAGD,SAAUC,GACR,GAAIA,IAAShB,KAAKE,SAAU,CAC1B,IAAMe,EAAOjB,KAAKE,SAClBF,KAAKE,SAAWc,EAChB,IAAK,IAAIE,EAAI,EAAGA,EAAIlB,KAAKC,UAAUkB,OAAQD,IACzClB,KAAKC,UAAUiB,GAAGlB,KAAKE,SAAUe,EAErC,CACF,iPAAC"}